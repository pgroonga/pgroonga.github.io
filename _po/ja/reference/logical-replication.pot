msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

msgid ""
"---\n"
"title: Logical replication\n"
"---"
msgstr ""

msgid "# Logical replication"
msgstr ""

msgid "PGroonga supports PostgreSQL built-in logical replication since 1.2.4. It requires PostgreSQL 10 or later."
msgstr ""

msgid "This document describes how to configure PostgreSQL built-in logical replication for PGroonga. Most of steps are normal steps. There are some PGroonga specific steps."
msgstr ""

msgid ""
"It doesn't have to be have same schema for source of replication and\n"
"destionation of replication for logical replication."
msgstr ""

msgid "Therefore, setting an index on only a destination of replication in here."
msgstr ""

msgid "## Summary"
msgstr ""

msgid "Here are steps to configure PostgreSQL built-in logical replication for PGroonga. \"[normal]\" tag means that the step is a normal step for logical replication. \"[special]\" tag means that the step is a PGroonga specific step."
msgstr ""

msgid "  1. [normal] Install PostgreSQL on Publisher and Subscriber"
msgstr ""

msgid "  2. [special] Install PGroonga on Subscriber"
msgstr ""

msgid "  3. [normal] Initialize PostgreSQL database on Publisher and Subscriber"
msgstr ""

msgid "  4. [normal] Add some logical replication configurations to `postgresql.conf` and `pg_hba.conf` on Publisher"
msgstr ""

msgid "  5. [normal] Create table on Publisher and Subscriber"
msgstr ""

msgid "  6. [normal] Create publication on Publisher"
msgstr ""

msgid "  7. [normal] Create subscription on Subscriber"
msgstr ""

msgid "  8. [special] Create a PGroonga index on Subscriber"
msgstr ""

msgid "  9. [normal] Insert data on Publisher"
msgstr ""

msgid "## Example environment"
msgstr ""

msgid "This document uses the following environment:"
msgstr ""

msgid "  * Publisher:"
msgstr ""

msgid "    * OS: CentOS 7"
msgstr ""

msgid "    * IP Address: 172.16.0.1"
msgstr ""

msgid "    * Database name: `blog`"
msgstr ""

msgid "    * Replication user name: `replicator`"
msgstr ""

msgid "    * Replication user password: `passw0rd`"
msgstr ""

msgid "  * Subscriber:"
msgstr ""

msgid "    * IP Address: 172.16.0.2"
msgstr ""

msgid "This document shows command lines for CentOS 7. If you're using other platforms, adjust command lines by yourself."
msgstr ""

msgid "## [normal] Install PostgreSQL on Publisher and Subscriber"
msgstr ""

msgid "This is a normal step."
msgstr ""

msgid "Install PostgreSQL {{ site.latest_postgresql_version }} on Publisher and Subscriber."
msgstr ""

msgid "Publisher and Subscriber:"
msgstr ""

msgid ""
"```console\n"
"% sudo -H yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -qf --queryformat=\"%{VERSION}\" /etc/redhat-release)-$(rpm -qf --queryformat=\"%{ARCH}\" /etc/redhat-release)/pgdg-redhat-repo-latest.noarch.rpm\n"
"% sudo yum install postgresql{{ site.latest_postgresql_version }}-server\n"
"```"
msgstr ""

msgid "See also [PostgreSQL: Linux downloads (CentOS)][postgresql-centos]."
msgstr ""

msgid "## [special] Install PGroonga on Subscriber"
msgstr ""

msgid "This is a PGroonga specific step."
msgstr ""

msgid "Install PGroonga on Subscriber."
msgstr ""

msgid "Subscriber:"
msgstr ""

msgid ""
"```console\n"
"% sudo -H yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -qf --queryformat=\"%{VERSION}\" /etc/redhat-release)-$(rpm -qf --queryformat=\"%{ARCH}\" /etc/redhat-release)/pgdg-redhat-repo-latest.noarch.rpm\n"
"% sudo -H yum install -y https://packages.groonga.org/centos/groonga-release-latest.noarch.rpm\n"
"% sudo -H yum install -y postgresql{{ site.latest_postgresql_version}}-pgroonga\n"
"```"
msgstr ""

msgid "## [normal] Initialize PostgreSQL database on Publisher and Subscriber"
msgstr ""

msgid "Initialize PostgreSQL database on Publisher and Subscriber."
msgstr ""

msgid ""
"```console\n"
"% sudo /usr/pgsql-{{ site.latest_postgresql_version }}/bin/postgresql-{{ site.latest_postgresql_version }}-setup initdb\n"
"% sudo systemctl enable --now postgresql-{{ site.latest_postgresql_version }}\n"
"```"
msgstr ""

msgid "## [normal] Add some logical replication configurations to `postgresql.conf` on Publisher"
msgstr ""

msgid "Add the following logical replication configurations to `postgresql.conf` on only Publisher:"
msgstr ""

msgid "  * `wal_level = logical`"
msgstr ""

msgid "    * See also [PostgreSQL: Documentation: Write Ahead Log][postgresql-wal-level]."
msgstr ""

msgid "  * `max_wal_senders = 2` (`= 1 (The number of Subscribers) * 2`. `* 2` is for unexpected connection close.)"
msgstr ""

msgid "    * See also [PostgreSQL: Documentation: Replication][postgresql-max-wal-senders]."
msgstr ""

msgid "  * `max_replication_slots = 1` (`= 1 (The number of Subscribers)`)."
msgstr ""

msgid "    * See also [PostgreSQL: Documentation: Replication][postgresql-max-replication-slots]."
msgstr ""

msgid "`/var/lib/pgsql/{{ site.latest_postgresql_version }}/data/postgresql.conf`:"
msgstr ""

msgid "Before:"
msgstr ""

msgid ""
"```text\n"
"#listen_address = 'localhost'"
msgstr ""

msgid ""
"#wal_level = minimal\n"
"#max_wal_senders = 0\n"
"#max_replication_slots = 0\n"
"```"
msgstr ""

msgid "After:"
msgstr ""

msgid ""
"```text\n"
"listen_address = '*'"
msgstr ""

msgid ""
"wal_level = logical\n"
"max_wal_senders = 2\n"
"max_replication_slots = 1\n"
"```"
msgstr ""

msgid "Add the following logical replication configurations to `pg_hba.conf` on only Publisher:"
msgstr ""

msgid "  * Accept replication connection by the replication user `replicator` from `172.16.0.2/32`."
msgstr ""

msgid "`/var/lib/pgsql/{{ site.latest_postgresql_version }}/data/pg_hba.conf`:"
msgstr ""

msgid ""
"```text\n"
"# \"local\" is for Unix domain socket connections only\n"
"local   all             all                                     trust\n"
"# IPv4 local connections:\n"
"host    all             all             127.0.0.1/32            trust\n"
"# IPv6 local connections:\n"
"host    all             all             ::1/128                 ident\n"
"# Allow replication connections from localhost, by a user with the\n"
"# replication privilege.\n"
"local   replication     all                                trust\n"
"host    replication     all        127.0.0.1/32            trust\n"
"host    replication     all        ::1/128                 trust\n"
"```"
msgstr ""

msgid ""
"```text\n"
"# \"local\" is for Unix domain socket connections only\n"
"local   all             all                                     trust\n"
"# IPv4 local connections:\n"
"host    all             all             127.0.0.1/32            trust\n"
"# IPv6 local connections:\n"
"host    all             all             ::1/128                 ident\n"
"# Allow replication connections from localhost, by a user with the\n"
"# replication privilege.\n"
"local   replication     all                                trust\n"
"host    replication     all        127.0.0.1/32            trust\n"
"host    replication     all        ::1/128                 trust"
msgstr ""

msgid ""
"# IPv4 remote connections:\n"
"host    all             replicator       172.16.0.2/32         md5\n"
"```"
msgstr ""

msgid "Restart PostgreSQL to apply the configuration:"
msgstr ""

msgid ""
"```console\n"
"% sudo -H systemctl restart postgresql-{{ site.latest_postgresql_version }}\n"
"```"
msgstr ""

msgid "Create the user for replication on only Publisher:"
msgstr ""

msgid ""
"```console\n"
"% /usr/pgsql-{{ site.latest_postgresql_version }}/bin/createuser --pwprompt replicator -U postgres\n"
"Enter password for new role: (passw0rd)\n"
"Enter it again: (passw0rd)\n"
"```"
msgstr ""

msgid "## [normal] Create table on Publisher and Subscriber"
msgstr ""

msgid "Create a normal user on Subscriber:"
msgstr ""

msgid ""
"```console\n"
"% /usr/pgsql-{{ site.latest_postgresql_version }}/bin/createuser ${USER} -U postgres\n"
"```"
msgstr ""

msgid "Create a database on Publisher and Subscriber:"
msgstr ""

msgid ""
"```console\n"
"% /usr/pgsql-{{ site.latest_postgresql_version }}/bin/createdb --owner ${USER} blog -U postgres\n"
"```"
msgstr ""

msgid ""
"Create a table in the created database.\n"
"Connect to the created `blog` database:"
msgstr ""

msgid ""
"```console\n"
"% /usr/pgsql-{{ site.latest_postgresql_version }}/bin/psql blog -U ${USER}\n"
"```"
msgstr ""

msgid "Create `entries` table:"
msgstr ""

msgid ""
"```sql\n"
"CREATE TABLE entries (\n"
"  title text,\n"
"  body text\n"
");\n"
"```"
msgstr ""

msgid "## [special] Create a PGroonga index on Subscriber"
msgstr ""

msgid "Install PGroonga to the database. It requires superuser privilege:"
msgstr ""

msgid ""
"```sql\n"
"CREATE EXTENSION pgroonga;\n"
"```"
msgstr ""

msgid "Create a PGroonga index on Subscriber:"
msgstr ""

msgid ""
"```sql\n"
"CREATE INDEX entries_full_text_search ON entries USING pgroonga (title, body);\n"
"```"
msgstr ""

msgid "Create a PUBLICATION on Publisher only:"
msgstr ""

msgid ""
"```sql\n"
"CREATE PUBLICATION pub_srv1_blog FOR TABLE entries;\n"
"```"
msgstr ""

msgid "Create a SUBSCRIPTION on Subscriber only:"
msgstr ""

msgid ""
"```sql\n"
"CREATE SUBSCRIPTION sub_srv2_blog CONNECTION 'dbname=blog hostaddr=172.16.0.2 port=5432 user=replicator password=passw0rd' PUBLICATION pub_srv1_blog;\n"
"```"
msgstr ""

msgid "## [normal] Insert data on Publisher only:"
msgstr ""

msgid "Insert data to the created `entries` table:"
msgstr ""

msgid ""
"```sql\n"
"INSERT INTO entries VALUES ('PGroonga', 'PGroonga is a PostgreSQL extension for fast full text search that supports all languages. It will help us.');\n"
"INSERT INTO entries VALUES ('Groonga', 'Groonga is a full text search engine used by PGroonga. We did not know about it.');\n"
"INSERT INTO entries VALUES ('PGroonga and replication', 'PGroonga 1.1.6 supports WAL based streaming replication. We should try it!');\n"
"```"
msgstr ""

msgid "Confirm replication:"
msgstr ""

msgid "Publisher:"
msgstr ""

msgid ""
"```sql\n"
"SELECT * FROM entries;\n"
" title    |                                  body\n"
" ---------+---------------------------------------------------------------------------\n"
" PGroonga | PGroonga is a PostgreSQL extension for fast full text search that supports all languages. It will help us.\n"
" Groonga  | Groonga is a full text search engine used by PGroonga. We did not know about it.\n"
" PGroonga and replication | PGroonga 1.1.6 supports WAL based streaming replication. We should try it!\n"
" (3 rows)\n"
"```"
msgstr ""

msgid "Now, we can search data replicated on subscriber by PGroonga index created on subscriber."
msgstr ""

msgid ""
"```sql\n"
"SET enable_seqscan TO off;\n"
"SELECT * FROM entries WHERE body &@ 'Groonga';\n"
"  title  |                                       body\n"
"---------+----------------------------------------------------------------------------------\n"
" Groonga | Groonga is a full text search engine used by PGroonga. We did not know about it.\n"
"(1 row)\n"
"```"
msgstr ""

msgid "[postgresql-wal-level]:{{ site.postgresql_doc_base_url.en }}/runtime-config-wal.html#GUC-WAL-LEVEL"
msgstr ""

msgid "[postgresql-max-wal-senders]:{{ site.postgresql_doc_base_url.en }}/runtime-config-replication.html#GUC-MAX-WAL-SENDERS"
msgstr ""

msgid "[postgresql-max-replication-slots]:{{ site.postgresql_doc_base_url.en }}/runtime-config-replication.html#GUC-MAX-REPLICATION-SLOTS"
msgstr ""

msgid "[postgresql-centos]:https://www.postgresql.org/download/linux/redhat/"
msgstr ""
